function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();window.Charm=function(){function a(){var b=this,c=arguments.length<=0||void 0===arguments[0]?PIXI:arguments[0];if(_classCallCheck(this,a),void 0===c)throw new Error("Please assign a rendering engine in the constructor before using charm.js");this.renderer="",c.ParticleContainer&&c.Sprite&&(this.renderer="pixi"),this.globalTweens=[],this.easingFormulas={linear:function(b){return b},smoothstep:function(b){return b*b*(3-2*b)},smoothstepSquared:function(b){return Math.pow(b*b*(3-2*b),2)},smoothstepCubed:function(b){return Math.pow(b*b*(3-2*b),3)},acceleration:function(b){return b*b},accelerationCubed:function(b){return Math.pow(b*b,3)},deceleration:function(b){return 1-Math.pow(1-b,2)},decelerationCubed:function(b){return 1-Math.pow(1-b,3)},sine:function(b){return Math.sin(b*Math.PI/2)},sineSquared:function(b){return Math.pow(Math.sin(b*Math.PI/2),2)},sineCubed:function(b){return Math.pow(Math.sin(b*Math.PI/2),2)},inverseSine:function(b){return 1-Math.sin((1-b)*Math.PI/2)},inverseSineSquared:function(b){return 1-Math.pow(Math.sin((1-b)*Math.PI/2),2)},inverseSineCubed:function(b){return 1-Math.pow(Math.sin((1-b)*Math.PI/2),3)},spline:function(b,c,d,e,f){return.5*(2*d+(-c+e)*b+(2*c-5*d+4*e-f)*b*b+(-c+3*d-3*e+f)*b*b*b)},cubicBezier:function(b,c,d,e,f){var g=b*b,h=g*b;return c+(3*-c+b*(3*c-c*b))*b+(3*d+b*(-6*d+3*d*b))*b+(3*e-3*e*b)*g+f*h}},this._addScaleProperties=function(a){"pixi"===b.renderer&&(!a.scaleX&&a.scale.x&&Object.defineProperty(a,"scaleX",{get:function(){return a.scale.x},set:function(c){a.scale.x=c}}),!a.scaleY&&a.scale.y&&Object.defineProperty(a,"scaleY",{get:function(){return a.scale.y},set:function(c){a.scale.y=c}}))}}return _createClass(a,[{key:"tweenProperty",value:function(b,c,d,e,f){var g=arguments.length<=5||void 0===arguments[5]?"smoothstep":arguments[5],h=this,i=!(arguments.length<=6||void 0===arguments[6])&&arguments[6],j=arguments.length<=7||void 0===arguments[7]?0:arguments[7],k={},l=g.split(" ");return"bounce"===l[0]&&(k.startMagnitude=parseInt(l[1]),k.endMagnitude=parseInt(l[2])),k.start=function(a,b){k.startValue=JSON.parse(JSON.stringify(a)),k.endValue=JSON.parse(JSON.stringify(b)),k.playing=!0,k.totalFrames=f,k.frameCounter=0,h.globalTweens.push(k)},k.start(d,e),k.update=function(){var d=void 0;if(k.playing)if(k.frameCounter<k.totalFrames){var e=k.frameCounter/k.totalFrames;d="bounce"!==l[0]?h.easingFormulas[g](e):h.easingFormulas.spline(e,k.startMagnitude,0,1,k.endMagnitude),b[c]=k.endValue*d+k.startValue*(1-d),k.frameCounter+=1}else b[c]=k.endValue,k.end()},k.end=function(){k.playing=!1,k.onComplete&&k.onComplete(),h.globalTweens.splice(h.globalTweens.indexOf(k),1),i&&h.wait(j).then(function(){k.start(k.endValue,k.startValue)})},k.play=function(){return k.playing=!0},k.pause=function(){return k.playing=!1},k}},{key:"makeTween",value:function(b){var c=this,d={};d.tweens=[],b.forEach(function(a){var b=c.tweenProperty.apply(c,_toConsumableArray(a));d.tweens.push(b)});var e=0;return d.completed=function(){e+=1,e===d.tweens.length&&(d.onComplete&&d.onComplete(),e=0)},d.tweens.forEach(function(a){a.onComplete=function(){return d.completed()}}),d.pause=function(){d.tweens.forEach(function(a){a.playing=!1})},d.play=function(){d.tweens.forEach(function(a){a.playing=!0})},d}},{key:"fadeOut",value:function(b){var c=arguments.length<=1||void 0===arguments[1]?60:arguments[1];return this.tweenProperty(b,"alpha",b.alpha,0,c,"sine")}},{key:"fadeIn",value:function(b){var c=arguments.length<=1||void 0===arguments[1]?60:arguments[1];return this.tweenProperty(b,"alpha",b.alpha,1,c,"sine")}},{key:"pulse",value:function(b){var c=arguments.length<=1||void 0===arguments[1]?60:arguments[1],d=arguments.length<=2||void 0===arguments[2]?0:arguments[2];return this.tweenProperty(b,"alpha",b.alpha,d,c,"smoothstep",!0)}},{key:"slide",value:function(b,c,d){var e=arguments.length<=3||void 0===arguments[3]?60:arguments[3],f=arguments.length<=4||void 0===arguments[4]?"smoothstep":arguments[4],g=!(arguments.length<=5||void 0===arguments[5])&&arguments[5],h=arguments.length<=6||void 0===arguments[6]?0:arguments[6];return this.makeTween([[b,"x",b.x,c,e,f,g,h],[b,"y",b.y,d,e,f,g,h]])}},{key:"breathe",value:function(b){var c=arguments.length<=1||void 0===arguments[1]?.8:arguments[1],d=arguments.length<=2||void 0===arguments[2]?.8:arguments[2],e=arguments.length<=3||void 0===arguments[3]?60:arguments[3],f=arguments.length<=4||void 0===arguments[4]||arguments[4],g=arguments.length<=5||void 0===arguments[5]?0:arguments[5];return this._addScaleProperties(b),this.makeTween([[b,"scaleX",b.scaleX,c,e,"smoothstepSquared",f,g],[b,"scaleY",b.scaleY,d,e,"smoothstepSquared",f,g]])}},{key:"scale",value:function(b){var c=arguments.length<=1||void 0===arguments[1]?.5:arguments[1],d=arguments.length<=2||void 0===arguments[2]?.5:arguments[2],e=arguments.length<=3||void 0===arguments[3]?60:arguments[3];return this._addScaleProperties(b),this.makeTween([[b,"scaleX",b.scaleX,c,e,"smoothstep",!1],[b,"scaleY",b.scaleY,d,e,"smoothstep",!1]])}},{key:"strobe",value:function(b){var c=arguments.length<=1||void 0===arguments[1]?1.3:arguments[1],d=arguments.length<=2||void 0===arguments[2]?10:arguments[2],e=arguments.length<=3||void 0===arguments[3]?20:arguments[3],f=arguments.length<=4||void 0===arguments[4]?10:arguments[4],g=arguments.length<=5||void 0===arguments[5]||arguments[5],h=arguments.length<=6||void 0===arguments[6]?0:arguments[6],i="bounce "+d+" "+e;return this._addScaleProperties(b),this.makeTween([[b,"scaleX",b.scaleX,c,f,i,g,h],[b,"scaleY",b.scaleY,c,f,i,g,h]])}},{key:"wobble",value:function(b){var c=arguments.length<=1||void 0===arguments[1]?1.2:arguments[1],d=arguments.length<=2||void 0===arguments[2]?1.2:arguments[2],e=arguments.length<=3||void 0===arguments[3]?10:arguments[3],f=arguments.length<=4||void 0===arguments[4]?10:arguments[4],g=arguments.length<=5||void 0===arguments[5]?10:arguments[5],h=arguments.length<=6||void 0===arguments[6]?-10:arguments[6],i=arguments.length<=7||void 0===arguments[7]?-10:arguments[7],j=arguments.length<=8||void 0===arguments[8]?.98:arguments[8],k=this,l=arguments.length<=9||void 0===arguments[9]||arguments[9],m=arguments.length<=10||void 0===arguments[10]?0:arguments[10],n="bounce "+f+" "+g,o="bounce "+h+" "+i;this._addScaleProperties(b);var p=this.makeTween([[b,"scaleX",b.scaleX,c,e,n,l,m],[b,"scaleY",b.scaleY,d,e,o,l,m]]);return p.tweens.forEach(function(a){a.onComplete=function(){a.endValue>1&&(a.endValue*=j,a.endValue<=1&&(a.endValue=1,k.removeTween(a)))}}),p}},{key:"followCurve",value:function(b,c,d){var e=arguments.length<=3||void 0===arguments[3]?"smoothstep":arguments[3],f=this,g=!(arguments.length<=4||void 0===arguments[4])&&arguments[4],h=arguments.length<=5||void 0===arguments[5]?0:arguments[5],i={},j=e.split(" ");return"bounce"===j[0]&&(i.startMagnitude=parseInt(j[1]),i.endMagnitude=parseInt(j[2])),i.start=function(a){i.playing=!0,i.totalFrames=d,i.frameCounter=0,i.pointsArray=JSON.parse(JSON.stringify(a)),f.globalTweens.push(i)},i.start(c),i.update=function(){var a=void 0,c=void 0,d=i.pointsArray;i.playing&&(i.frameCounter<i.totalFrames?(a=i.frameCounter/i.totalFrames,c="bounce"!==j[0]?f.easingFormulas[e](a):f.easingFormulas.spline(a,i.startMagnitude,0,1,i.endMagnitude),b.x=f.easingFormulas.cubicBezier(c,d[0][0],d[1][0],d[2][0],d[3][0]),b.y=f.easingFormulas.cubicBezier(c,d[0][1],d[1][1],d[2][1],d[3][1]),i.frameCounter+=1):i.end())},i.end=function(){i.playing=!1,i.onComplete&&i.onComplete(),f.globalTweens.splice(f.globalTweens.indexOf(i),1),g&&f.wait(h).then(function(){i.pointsArray=i.pointsArray.reverse(),i.start(i.pointsArray)})},i.pause=function(){i.playing=!1},i.play=function(){i.playing=!0},i}},{key:"walkPath",value:function(b,c){var d=arguments.length<=2||void 0===arguments[2]?300:arguments[2],e=arguments.length<=3||void 0===arguments[3]?"smoothstep":arguments[3],f=!(arguments.length<=4||void 0===arguments[4])&&arguments[4],g=this,h=!(arguments.length<=5||void 0===arguments[5])&&arguments[5],i=arguments.length<=6||void 0===arguments[6]?0:arguments[6],j=JSON.parse(JSON.stringify(c)),k=d/j.length,l=0,m=function a(c){var d=g.makeTween([[b,"x",j[c][0],j[c+1][0],k,e],[b,"y",j[c][1],j[c+1][1],k,e]]);return d.onComplete=function(){c+=1,c<j.length-1?g.wait(i).then(function(){d=a(c)}):f&&(h&&j.reverse(),g.wait(i).then(function(){c=0,b.x=j[0][0],b.y=j[0][1],d=a(c)}))},d},n=m(l);return n}},{key:"walkCurve",value:function(b,c){var d=arguments.length<=2||void 0===arguments[2]?300:arguments[2],e=arguments.length<=3||void 0===arguments[3]?"smoothstep":arguments[3],f=!(arguments.length<=4||void 0===arguments[4])&&arguments[4],g=this,h=!(arguments.length<=5||void 0===arguments[5])&&arguments[5],i=arguments.length<=6||void 0===arguments[6]?0:arguments[6],j=d/c.length,k=0,l=function a(d){var k=g.followCurve(b,c[d],j,e);return k.onComplete=function(){d+=1,d<c.length?g.wait(i).then(function(){k=a(d)}):f&&(h&&(c.reverse(),c.forEach(function(a){return a.reverse()})),g.wait(i).then(function(){d=0,b.x=c[0][0],b.y=c[0][1],k=a(d)}))},k},m=l(k);return m}},{key:"wait",value:function(){var b=arguments.length<=0||void 0===arguments[0]?0:arguments[0];return new Promise(function(a,c){setTimeout(a,b)})}},{key:"removeTween",value:function(b){var c=this;b.tweens?(b.pause(),b.tweens.forEach(function(a){c.globalTweens.splice(c.globalTweens.indexOf(a),1)})):(b.pause(),this.globalTweens.splice(this.globalTweens.indexOf(b),1))}},{key:"update",value:function(){if(this.globalTweens.length>0)for(var b=this.globalTweens.length-1;b>=0;b--){var c=this.globalTweens[b];c&&c.update()}}}]),a}();
